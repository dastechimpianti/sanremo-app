<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ranking Sanremo 2025</title>
  <style>
    /* Stile generale */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      background: linear-gradient(45deg, #ff9a9e, #fad0c4);
    button { padding: 10px 20px; margin: 5px; }
    #ranking, #stats { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Confronta le canzoni di Sanremo 2025</h1>
  <h2>Pia che cazzo condividi</h2>
  <p>Scegli quale canzone preferisci tra le due proposte.</p>
  
  <div id="comparison">
    <div id="song1" class="song"></div>
    <div id="song2" class="song"></div>
  </div>
  
  <div style="text-align: center;">
    <button id="choose1">Scegli il primo</button>
    <button id="choose2">Scegli il secondo</button>
  </div>
  
  <!-- Statistiche: numero di confronti e affidabilità della classifica -->
  <div id="stats"></div>
  
  <h2>Classifica attuale</h2>
  <div id="ranking"></div>
  
  <script>
    // Lista delle canzoni con rating iniziale 1500
    const songs = [
      { id: 1, artist: "Francesco Gabbani", title: "Viva la vita", rating: 1500 },
      { id: 2, artist: "Clara", title: "Febbre", rating: 1500 },
      { id: 3, artist: "Achille Lauro", title: "Incoscienti giovani", rating: 1500 },
      { id: 4, artist: "Brunori Sas", title: "L'albero delle noci", rating: 1500 },
      { id: 5, artist: "Shablo feat. Gue', Joshua e Tormento", title: "La mia parola", rating: 1500 },
      { id: 6, artist: "Giorgia", title: "La cura per me", rating: 1500 },
      { id: 7, artist: "Emis Killa", title: "Demoni", rating: 1500 },
      { id: 8, artist: "Marcella Bella", title: "Pelle diamante", rating: 1500 },
      { id: 9, artist: "Gaia", title: "Chiamo io chiami tu", rating: 1500 },
      { id: 10, artist: "Simone Cristicchi", title: "Quando sarai piccola", rating: 1500 },
      { id: 11, artist: "Irama", title: "Lentamente", rating: 1500 },
      { id: 12, artist: "Serena Brancale", title: "Anema e Core", rating: 1500 },
      { id: 13, artist: "Olly", title: "Balorda nostalgia", rating: 1500 },
      { id: 14, artist: "Elodie", title: "Dimenticarsi alle 7", rating: 1500 },
      { id: 15, artist: "Massimo Ranieri", title: "Tra le mani un cuore", rating: 1500 },
      { id: 16, artist: "Tony Effe", title: "Damme 'na mano", rating: 1500 },
      { id: 17, artist: "Sarah Toscano", title: "Amarcord", rating: 1500 },
      { id: 18, artist: "Rocco Hunt", title: "Mille vote ancora", rating: 1500 },
      { id: 19, artist: "Lucio Corsi", title: "Volevo essere un duro", rating: 1500 },
      { id: 20, artist: "Noemi", title: "Se t'innamori muori", rating: 1500 },
      { id: 21, artist: "Bresh", title: "La tana del granchio", rating: 1500 },
      { id: 22, artist: "Rose Villain", title: "Fuorilegge", rating: 1500 },
      { id: 23, artist: "Willie Peyote", title: "Grazie ma no grazie", rating: 1500 },
      { id: 24, artist: "Moda'", title: "Non ti dimentico", rating: 1500 },
      { id: 25, artist: "Fedez", title: "Battito", rating: 1500 },
      { id: 26, artist: "Francesca Michielin", title: "Fango in paradiso", rating: 1500 },
      { id: 27, artist: "Rkomi", title: "Il ritmo delle cose", rating: 1500 },
      { id: 28, artist: "Coma_Cose", title: "Cuoricini", rating: 1500 },
      { id: 29, artist: "Joan Thiele", title: "Eco", rating: 1500 },
      { id: 30, artist: "The Kolors", title: "Tu con chi fai l'amore", rating: 1500 }
    ];
    
    // Parametro K per il sistema Elo
    const K = 32;
    
    // Calcola il punteggio atteso tra due canzoni
    function expectedScore(ratingA, ratingB) {
      return 1 / (1 + Math.pow(10, (ratingB - ratingA) / 400));
    }
    
    // Aggiorna i rating di vincitore e perdente
    function updateRatings(winner, loser) {
      const expWin = expectedScore(winner.rating, loser.rating);
      const expLose = expectedScore(loser.rating, winner.rating);
      winner.rating = winner.rating + K * (1 - expWin);
      loser.rating = loser.rating + K * (0 - expLose);
    }
    
    // Seleziona casualmente due canzoni differenti
    function getRandomPair() {
      let idx1 = Math.floor(Math.random() * songs.length);
      let idx2;
      do {
        idx2 = Math.floor(Math.random() * songs.length);
      } while(idx2 === idx1);
      return [songs[idx1], songs[idx2]];
    }
    
    // Variabili globali per la coppia corrente e il contatore delle scelte
    let currentPair = getRandomPair();
    let choicesCount = 0;
    // Totale di confronti possibili (per 30 canzoni: 435, per 29 canzoni: 406)
    const totalPossibleComparisons = songs.length * (songs.length - 1) / 2;
    
    // Funzione per visualizzare la coppia corrente
    function displayPair() {
      document.getElementById('song1').innerHTML = `<strong>${currentPair[0].artist}</strong><br>${currentPair[0].title}<br>Rating: ${Math.round(currentPair[0].rating)}`;
      document.getElementById('song2').innerHTML = `<strong>${currentPair[1].artist}</strong><br>${currentPair[1].title}<br>Rating: ${Math.round(currentPair[1].rating)}`;
    }
    
    // Funzione per visualizzare la classifica
    function displayRanking() {
      const sortedSongs = [...songs].sort((a, b) => b.rating - a.rating);
      let html = '<ol>';
      sortedSongs.forEach(song => {
        html += `<li><strong>${song.artist}</strong> - ${song.title} (Rating: ${Math.round(song.rating)})</li>`;
      });
      html += '</ol>';
      document.getElementById('ranking').innerHTML = html;
    }
    
    // Funzione per aggiornare le statistiche
    function updateStats() {
      // Calcolo della percentuale: se hai effettuato tutti i confronti possibili, l'affidabilità è al 100%
      let percentage = Math.min((choicesCount / totalPossibleComparisons) * 100, 100);
      document.getElementById('stats').innerText = `Scelte effettuate: ${choicesCount} | Affidabilità: ${percentage.toFixed(1)}%`;
    }
    
    // Gestione degli eventi dei pulsanti
    document.getElementById('choose1').addEventListener('click', () => {
      updateRatings(currentPair[0], currentPair[1]);
      choicesCount++;
      currentPair = getRandomPair();
      displayPair();
      displayRanking();
      updateStats();
    });
    
    document.getElementById('choose2').addEventListener('click', () => {
      updateRatings(currentPair[1], currentPair[0]);
      choicesCount++;
      currentPair = getRandomPair();
      displayPair();
      displayRanking();
      updateStats();
    });
    
    // Visualizza la prima coppia, la classifica iniziale e le statistiche
    displayPair();
    displayRanking();
    updateStats();
  </script>
</body>
</html>
